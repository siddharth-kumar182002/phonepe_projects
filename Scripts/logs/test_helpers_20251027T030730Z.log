2025-10-27 08:37:30,809 [INFO] Connecting to stg-hdpsiddharth105.phonepe.nb6(10.57.40.172):2181, use_ssl: False
2025-10-27 08:37:30,917 [INFO] Zookeeper connection established, state: CONNECTED
2025-10-27 08:37:31,014 [ERROR] Failed to check balancer state: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
Traceback (most recent call last):
  File "/Users/siddharth5.intern/Desktop/Projects/Scripts/helpers.py", line 1548, in get_balancer_state_zk
    state_str = data.decode('utf-8').strip().lower()
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
2025-10-27 08:37:31,018 [INFO] Closing connection to stg-hdpsiddharth105.phonepe.nb6:2181
2025-10-27 08:37:31,018 [INFO] Zookeeper session closed, state: CLOSED
2025-10-27 08:37:31,019 [ERROR] get_balancer_state_zk failed
Traceback (most recent call last):
  File "/Users/siddharth5.intern/Desktop/Projects/Scripts/helpers.py", line 1548, in get_balancer_state_zk
    state_str = data.decode('utf-8').strip().lower()
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/siddharth5.intern/Desktop/Projects/Scripts/test_helpers.py", line 47, in <module>
    balancer_state = get_balancer_state_zk(cfg, logger)
  File "/Users/siddharth5.intern/Desktop/Projects/Scripts/helpers.py", line 1560, in get_balancer_state_zk
    raise RuntimeError(f"Could not determine balancer state: {e}")
RuntimeError: Could not determine balancer state: 'utf-8' codec can't decode byte 0xff in position 0: invalid start byte
2025-10-27 08:37:31,022 [INFO] Connecting to stg-hdpsiddharth105.phonepe.nb6(10.57.40.172):2181, use_ssl: False
2025-10-27 08:37:31,113 [INFO] Zookeeper connection established, state: CONNECTED
2025-10-27 08:37:31,215 [INFO] Closing connection to stg-hdpsiddharth105.phonepe.nb6:2181
2025-10-27 08:37:31,215 [INFO] Zookeeper session closed, state: CLOSED
2025-10-27 08:37:31,678 [INFO] Found sample region to unassign: hbase:namespace,,1758625397863.540102f707c052582c6a87b19e874455.
2025-10-27 08:39:16,382 [ERROR] Unexpected error during unassign for region hbase:namespace,,1758625397863.540102f707c052582c6a87b19e874455.: TClient instance has no attribute 'unassignRegion'
Traceback (most recent call last):
  File "/Users/siddharth5.intern/Desktop/Projects/Scripts/helpers.py", line 1614, in unassign_region_happybase_fallback
    hb_conn.client.unassignRegion(region_bytes, True) # Force = True
  File "/Users/siddharth5.intern/Desktop/Projects/Scripts/venv/lib/python3.9/site-packages/thriftpy2/thrift.py", line 193, in __getattr__
    raise AttributeError("{} instance has no attribute '{}'".format(
AttributeError: TClient instance has no attribute 'unassignRegion'
2025-10-27 08:39:16,389 [ERROR] unassign_region_happybase_fallback failed
Traceback (most recent call last):
  File "/Users/siddharth5.intern/Desktop/Projects/Scripts/test_helpers.py", line 73, in <module>
    unassign_region_happybase_fallback(cfg, region_to_test, logger)
  File "/Users/siddharth5.intern/Desktop/Projects/Scripts/helpers.py", line 1614, in unassign_region_happybase_fallback
    hb_conn.client.unassignRegion(region_bytes, True) # Force = True
  File "/Users/siddharth5.intern/Desktop/Projects/Scripts/venv/lib/python3.9/site-packages/thriftpy2/thrift.py", line 193, in __getattr__
    raise AttributeError("{} instance has no attribute '{}'".format(
AttributeError: TClient instance has no attribute 'unassignRegion'
